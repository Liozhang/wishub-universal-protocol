; WisHub MVP Supervisord配置文件
; 用途：使用Supervisord管理WisHub MVP进程（无需sudo权限）

[supervisord]
; Supervisord主进程配置
nodaemon=false
logfile=./logs/supervisord.log
pidfile=./supervisord.pid
childlogdir=./logs
user=wuying

; 程序配置
[program:wishub-api]
; WisHub API服务
command=/home/wuying/clawd/omni-knowledge-graph/venv/bin/python -m uvicorn app.main:app --host 0.0.0.0 --port 8000
directory=/home/wuying/clawd/omni-knowledge-graph
user=wuying
autostart=true
autorestart=true
startretries=3
startsecs=5
stopasgroup=true
killasgroup=true
stderr_logfile=./logs/wishub-api-err.log
stderr_logfile_maxbytes=50MB
stderr_logfile_backups=10
stdout_logfile=./logs/wishub-api-out.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10
environment=AWSKMS_KEY_ID="arn:aws:kms:us-east-1:012345678910:key/abcd1234-5678-90ab-cdef-0123456789ab"

[program:wishub-redis]
; Redis服务（可选）
command=redis-server --port 6379 --dir ./data/redis --logfile ./logs/redis.log
directory=/home/wuying/clawd/omni-knowledge-graph
user=wuying
autostart=true
autorestart=true
startretries=3
startsecs=5
stopasgroup=true
killasgroup=true
stderr_logfile=./logs/redis-err.log
stderr_logfile_maxbytes=50MB
stderr_logfile_backups=10
stdout_logfile=./logs/redis-out.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10

; 网络服务器配置（可选，用于Supervisord远程管理）
[inet_http_server]
port=127.0.0.1:9001
username=user
password=123

; RPC接口配置（可选）
[supervisorctl]
serverurl=unix:///tmp/supervisor.sock
username=user
password=123

; 分组配置（可选，用于批量管理）
[group:wishub-programs]
programs=wishub-api,wishub-redis
priority=999
